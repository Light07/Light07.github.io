<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误，请关注公众号iTesting获取密码');
                history.back();
            }
        }
    })();
</script>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  






  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="测试框架,automation," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="之前分享过很多优秀的测试框架，总觉得意犹未尽，干脆自己撸起袖子写一个。 添加微信公众号iTesting 查看原文。">
<meta property="og:type" content="article">
<meta property="og:title" content="自研测试框架Ktest介绍">
<meta property="og:url" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/index.html">
<meta property="og:site_name" content="iTesting软件测试知识分享">
<meta property="og:description" content="之前分享过很多优秀的测试框架，总觉得意犹未尽，干脆自己撸起袖子写一个。 添加微信公众号iTesting 查看原文。">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/project_summary.JPG">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/ktest_summary.JPG">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/run_console.JPG">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/html_report_folder.JPG">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/html_report.JPG">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/set_up_class_decorator.JPG">
<meta property="og:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/test_finder.JPG">
<meta property="og:updated_time" content="2019-01-24T15:39:27.395Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="自研测试框架Ktest介绍">
<meta name="twitter:description" content="之前分享过很多优秀的测试框架，总觉得意犹未尽，干脆自己撸起袖子写一个。 添加微信公众号iTesting 查看原文。">
<meta name="twitter:image" content="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/project_summary.JPG">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/"/>





  <title> 自研测试框架Ktest介绍 | iTesting软件测试知识分享 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>
	<a href="https://github.com/Light07/PythonFramework0To1" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

<!--
  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">iTesting软件测试知识分享</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">iTesting</h1>
    
</div>
-->

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
		
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-basic-knowledge">
          <a href="/categories/basic-knowledge" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            测试理论
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-front-end-related">
          <a href="/categories/front-end-related" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-desktop"></i> <br />
            
            前端自动化
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-dev-in-test">
          <a href="/categories/dev-in-test" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flask"></i> <br />
            
            测试开发
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-automation">
          <a href="/categories/automation" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-repeat"></i> <br />
            
            自动化测试
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-api-test">
          <a href="/categories/api-test" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-paper-plane-o"></i> <br />
            
            接口测试
          </a>
        </li>
		
      
        
		
      
        
		
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="请关注微信公众号 iTesting">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="iTesting软件测试知识分享">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="iTesting软件测试知识分享" src="/images/avatar.jpg">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                自研测试框架Ktest介绍
              
            
          </h2>
        

        <div class="post-meta">
        
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-29T22:57:54+08:00">
                2018-12-29
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2019-01-24T23:39:27+08:00">
                2019-01-24
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev-in-test/" itemprop="url" rel="index">
                    <span itemprop="name">dev-in-test</span>
                  </a>
                </span>

                
                
              
            </span>
          
			  <span class="post-meta-divider">|</span>
			  <span class="post-meta-item-icon">
               <i class="fa fa-folder-o"></i>
              </span>
			  <span class="post-count">全文共计5.5k字</span>
			  <span class="post-meta-divider">|</span>
			  <span class="post-meta-item-icon">
               <i class="fa fa-folder-o"></i>
              </span>
			  <span class="post-count">预计阅读时间21分钟</span>

          
            
          

          

          
          

          

          




        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>之前分享过很多优秀的测试框架，总觉得意犹未尽，干脆自己撸起袖子写一个。 添加微信公众号iTesting 查看原文。</p>
<a id="more"></a>
<p>在自动化测试的过程中，测试框架是我们绕不过去的一个工具，无论你是不需要写代码直接改动数据生成脚本，还是你需要检查测试结果甚至持续集成，测试框架都在发挥它的作用。<br>不同编程语言的实现出来的框架也不尽相同，但是思想总是相通的，比如尽量使框架使用者只关注自己的业务，框架帮助处理错误截图，保存错误log，出错重试甚至跟jenkins持续集成等。</p>
<p>可以说，一个还算合格的测试框架，可以大大提升测试效率；一个优秀的测试框架，说它能把测试人员从繁缛复杂的跟业务无关但又不得不做的工作中解脱出来也不为过。既然框架的作用这么明显，那么有哪些优秀的测试框架可以给我们用呢？</p>
<p>大家都知道， java里有TestNG， python里有unittest，pytest等优秀的“官方”框架， 我对python比较熟悉，之前也介绍过很多这方面的文章，相信大家也多少看过一两篇。<br>可以说，能把这些经过百万人检验的“官方”测试框架工具用好用顺，拿下本职工作根本不在话下，更不用说你还能用好围绕着这些工具的生态库了，那简直是如入无人之地。</p>
<p>那么，为什么还要自己写一个框架呢？</p>
<p>相信常做自动化的都有自己的感悟， 比如自己业务没那么复杂，官方框架显得太重了；比如官方框架依赖很多的第三方库，每个要单独安装，更新，而且每个都有自己的用法，学习成本高；<br>再比如说，鞋子合脚不合脚，有的人要穿7年才能知道（对，那谁）。</p>
<h4 id="痛点："><a href="#痛点：" class="headerlink" title="痛点："></a>痛点：</h4><p>对于常用python写自动化的来说，unittest本身很优秀，但是不支持并发，而且测试报告支持的也不好，也不支持数据驱动。<br>pytest那里都好，就是吃了酒香不怕巷子深的亏，那个docouments真要心非常静才能读下去， 另外什么功能都需要额外安装一个库，你想并发？好，装一个pytest-parallel，你想报告html展示？好，装个pytest-html， 你想要错误的测试用例自动重跑一遍？好，装个pytest-rerunfailures。 强大是强大，感觉有点过于繁琐了。</p>
<h4 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h4><p>基于上述痛点，大部分同学选择在原有开源框架上二次开发，比如unittest集合多线程threading.Thread实现并发，加入HTMLTestRunner实现报告展示，引入ddt实现数据驱动，然后美其名曰，我写了个框架，我每次听到都是先很崇拜，然后晚上暗搓搓拉下代码一看，MD，这不是就是搭了个积木取名要你命3000吗？你还不能说人家说自己写了一个框架不对，何况这个框架通常也很好用。<br>用pytest就不更用说了，连并发都有两个库，一个xdist，一个pytest-parallel，每次都患选择恐惧症。</p>
<p>再有，开源的框架，毕竟普适多于贴合，跟自己的业务有时候就不那么紧密，为了使用某个具体功能还得引入很大一个包，也不是非常方便，另外最关键的一点是，我总觉得自己还行，想站起来试试 ：）</p>
<h4 id="框架是什么？我是怎么考虑框架的？"><a href="#框架是什么？我是怎么考虑框架的？" class="headerlink" title="框架是什么？我是怎么考虑框架的？"></a>框架是什么？我是怎么考虑框架的？</h4><p>之前分享过几篇文章，<br><a href="https://helloqa.com/2017/04/04/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%88%91%E8%A7%81/" target="_blank" rel="external">测试框架之我见</a><br><a href="https://helloqa.com/2017/04/04/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A1%86%E6%9E%B6%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/" target="_blank" rel="external">web自动化框架实践指南</a><br><a href="https://helloqa.com/2018/07/30/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/Python%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E5%AE%9E%E8%B7%B5/" target="_blank" rel="external">Python接口测试框架实践</a><br><a href="https://helloqa.com/2018/07/31/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A1%86%E6%9E%B6Pytest%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%86%9F%E7%BB%83%E4%BD%BF%E7%94%A8/" target="_blank" rel="external">pytest框架从入门到精通</a><br>《测试框架之我见》， 《web自动化框架实践指南》， 《接口测试框架实践》， 《pytest框架从入门到精通》。 这些都是我工作的一些感悟，和对框架的一些思考，可以看到思想也是循序渐进的。你也可以看到不是“官方”框架，就是二次开发的“官方”框架。 当然也可以说我是常怀觊觎之心，不停研究的目的就是我个人非常想有一套完全自己实现的框架。</p>
<h4 id="什么是ktest？"><a href="#什么是ktest？" class="headerlink" title="什么是ktest？"></a>什么是ktest？</h4><p>一句话：</p>
<blockquote>
<p>ktest is a common test framework support for Both UI and API test with run in parallel ability。<br>跟其它的框架有什么不同？<br>除标准库之外，原则上不引入任何第3方库，所有的一切都自己实现。比如并发就老老实实自己设计规则多线程并发，不用xdist或者pytst-parallel了，比如错误重跑，HTML报告都是自己实现了。</p>
</blockquote>
<h4 id="参考了谁？"><a href="#参考了谁？" class="headerlink" title="参考了谁？"></a>参考了谁？</h4><p>我当然不是闭门造车，参考了unittest，pytest，ddt，还有自己公司的官方框架， 读了部分源码，研究了下部分功能实现原理。</p>
<h4 id="实现的功能："><a href="#实现的功能：" class="headerlink" title="实现的功能："></a>实现的功能：</h4><p>1.多线程并发。（整套框架代码没出现任何哪怕一句threading，实现了并发，神奇不，嘿嘿）<br>2.分布式并发。（借助selenium-grid）<br>3.数据驱动。（一条用例两条数据会被当成两个用例，并展示在最终报告里）<br>4.同个测试类数据共享，每个测试用例数据独立。setUpClass， tearDownClass， setUp， tearDown（一看就是unittest的概念，只不过我自己实现了）。<br>4.动态生成，挑选，运行测试用例。（大量借助装饰器）<br>5.Web UI自动化测试每条用例错误自动截屏，记录log信息，自动重跑机制。<br>6.HTML报告。<br>7.XML格式for Jenkins。（马上完成，姑且算完成吧）<br>现在还是第一版，我个人想把它写成一个通用的测试框架，即可服务于web UI自动化测试，又可服务于API测试。当然还有很长的路要走。</p>
<h4 id="详细介绍"><a href="#详细介绍" class="headerlink" title="详细介绍"></a>详细介绍</h4><p>先不介绍技术细节， 先把自己放在一个业务测试，或者刚接触自动化脚本的测试角色上，我拿到了一个测试框架，我最先想到的是什么？ 如何用对吧？ 用这个框架，我原有的测试用例需要做哪些改变？这个框架有哪些方便？你对框架的期待有哪些？<br>1.使用简单，介绍详细。<br>2.能让我方便的查找， 生成， 运行， 清理测试用例及测试数据。<br>3.对业务的侵袭小，我迁移成本低。<br>4.功能强大，报告美观。<br>5.稳定，bug少。</p>
<p>下面就详细介绍：</p>
<h4 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#目前部署在自己公司的pypi库上，后期会上传到pypi。</span></div><div class="line">pip install ktest --index-url http://jenkin.xxxx.com:<span class="number">8081</span>/pypi --trusted-host jenkins.xxxx.com</div><div class="line"><span class="comment">#安装好后，你可以在 Python安装目录下的如下文件找到安装的包\Lib\site-packages</span></div></pre></td></tr></table></figure>
<h4 id="你的项目应该包括哪些："><a href="#你的项目应该包括哪些：" class="headerlink" title="你的项目应该包括哪些："></a>你的项目应该包括哪些：</h4><p>在讲用法前，我们先来直观看下，你的项目目应该是什么样子的<br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/project_summary.JPG" alt=""><br>你的项目中应该包含：<br>1.pages package， 这里面放你所有待测试页面，每个页面作为一个page object来保存。<br>2.tests package， 这个文件夹下面放所有的测试用例，包括你的数据驱动，断言都在这里。<br>3.settings package， 这个里面放了一些框架里会用到的参数，当然也可以放你自己的配置。 如果你不知道框架用到哪些变量，你可以暂时不建立它，运行时框架会帮你自动生成。</p>
<p>可以看到，你只需要把精力放在你本身的业务上就好了。</p>
<h4 id="ktest框架组成"><a href="#ktest框架组成" class="headerlink" title="ktest框架组成"></a>ktest框架组成</h4><p>package建立好了，我的测试用例，及我的待测页面要如何组织才能接入框架呢？ 别急，我们先来看看框架本身长什么样子。<br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/ktest_summary.JPG" alt=""></p>
<h4 id="功能列表"><a href="#功能列表" class="headerlink" title="功能列表"></a>功能列表</h4><p>看用红框标记起来的部分：<br>Common – 框架精华<br>1.欢迎关注公众号iTesting，跟万人测试团一起成长。<br>2.abstract_base_page.py 这个文件有是为了你自己项目的pages准备的，你的每一个待测页面或者功能都应该继承自这个文件中的类，并重写一些特定的函数。<br>3.api_base_case.py 创建了为api测试而用的基类。<br>4.enumeration.py 一些枚举变量，比如测试类的setup 和tearDown等，主要为了防止代码里写错及方便修改。<br>5.get_platform_info.py 判断运行的系统环境是windows，还是linux， 框架开始前会清理执行环境。<br>6.get_project_info.py 用于拿到你的项目文件的根目录。<br>7.html_reporter.py 用于生成HTML报告。<br>8.klogger.py 用于全局logger或者每个case独立logger。<br>9.selenium_helper.py 基于selenium封装的一些toolkit， 比如打开浏览器，使用chrome headless模式，关闭浏览器等。方便你快速开展工作。<br>10.test_case_finder.py 用于测试用例的查找和组织。 根据你的用户输入来进行，默认从tests 这个package下找所有被标记为@TestClass， @Test并且enable的用例。<br>11.test_decorator.py 用于标记测试类，测试用例，并且赋予每个测试类和测试用例独特的属性，方便test_case_finder查找。<br>12.test_filter.py 所有测试用例查找到后，根据用户的输入进行filter，最终保留出当次运行需要的测试类，测试函数及测试数据的组合。<br>13.ui_base_page.py UI的公用页，所有的UI Case 都继承自此。<br>14.user_options.py 接受用户参数并分析，最终为框架所用，包括要哪些用例运行，这些用例比如属于哪个组，那个测试类， 多线程还是单线程。 都在这里设置。</p>
<p>utiilites – 拿来即用测试套件<br>这里面放一些半成品，比如连接数据库脚本，比如用excel做数据驱动，对excel进行读写的脚本。 用户不需要操心连接的建立，销毁等。</p>
<p>main.py 用来运行框架，并发运行控制也是在这里。并发我“舍弃”了threading.Thread， 代码量下降一半以上，且不用操心锁。</p>
<p>setup.py 用来把框架打包。</p>
<h4 id="集成你的项目"><a href="#集成你的项目" class="headerlink" title="集成你的项目"></a>集成你的项目</h4><p>框架也看了，我的项目也建了， 我们的测试类和测试方法应该怎么写？<br>还拿我一直用的baidu来举例，你的项目pages package下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#bai_du.py</span></div><div class="line"><span class="comment">#coding=utf-8</span></div><div class="line">__author__ = <span class="string">'iTesting'</span></div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">from</span> common.abstract_base_page <span class="keyword">import</span> AbstractBasePage</div><div class="line"><span class="keyword">from</span> page_objects <span class="keyword">import</span> page_element</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BAI_DU</span><span class="params">(AbstractBasePage)</span>:</span></div><div class="line">    BAI_DU_HOME = <span class="string">"http://www.baidu.com"</span></div><div class="line">    SEARCH_DIALOG_ID = <span class="string">"kw"</span></div><div class="line">    SEARCH_ICON_ID = <span class="string">"su"</span></div><div class="line">    MEMBER_COUNT_XPATH = <span class="string">"//option[@value='10']"</span></div><div class="line">    SAVE_XPATH = <span class="string">".//*[@id='save']"</span></div><div class="line">    search_input_dialog = page_element(id_=SEARCH_DIALOG_ID)</div><div class="line">    search_icon = page_element(id_=SEARCH_ICON_ID)</div><div class="line">    member_count = page_element(xpath=MEMBER_COUNT_XPATH)</div><div class="line">    save_button = page_element(xpath=SAVE_XPATH)</div><div class="line">	</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, browser)</span>:</span></div><div class="line">        self.browser = browser</div><div class="line">        AbstractBasePage.__init__(self, browser)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_target_page</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser.get(self.BAI_DU_HOME)</div><div class="line">        print(self.is_element_displayed_on_page(self.search_icon))</div><div class="line">        <span class="keyword">return</span> self.is_element_displayed_on_page(self.search_icon)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self, search_string)</span>:</span></div><div class="line">        self.search_input_dialog.send_keys(search_string)</div><div class="line">        self.search_icon.click()</div><div class="line">        time.sleep(<span class="number">5</span>)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preferences</span><span class="params">(self)</span>:</span></div><div class="line">        browser = self.browser</div><div class="line">        browser.get(self.BAI_DU_HOME + <span class="string">"/gaoji/preferences.html"</span>)</div><div class="line">        self.member_count.click()</div><div class="line">        time.sleep(<span class="number">1</span>)</div><div class="line">        self.save_button.click()</div><div class="line">        time.sleep(<span class="number">1</span>)</div><div class="line">        browser.switch_to_alert().accept()</div></pre></td></tr></table></figure><br>每一个你的测试类（待测页面）你需要：<br>1.测试类继承AbstractBasePage， 然后page_object模式就可以使用了。<br>2.测试类要实现is_target_page函数，返回值是True或者False， 运行中如果返回值False，会Raise Error并停止本测试类后续运行。<br>3.如果你不用page objectmm模式，你无需遵守上述规定。</p>
<p>你的tests package下测试用例定义<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># test_baidu.py</span></div><div class="line"><span class="comment">#coding=utf-8</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">from</span> common.selenium_helper <span class="keyword">import</span> SeleniumHelper</div><div class="line"><span class="keyword">from</span> common.test_case_finder <span class="keyword">import</span> data_provider</div><div class="line"><span class="keyword">from</span> common.test_decorator <span class="keyword">import</span> TestClass, SetUpClass, Test, TearDownClass</div><div class="line"><span class="keyword">from</span> pages.baidu <span class="keyword">import</span> BAI_DU</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@TestClass(group='smoke', enabled=True)</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestBaidu</span>:</span></div><div class="line">    test_case_id = <span class="string">'3'</span></div><div class="line"><span class="meta">    @SetUpClass()</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">before</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser = SeleniumHelper.open_browser(<span class="string">'firefox'</span>)</div><div class="line">        self.baidu = BAI_DU(self.browser)</div><div class="line"><span class="meta">    @data_provider([('baidu',), ('google',)])</span></div><div class="line"><span class="meta">    @Test()</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_baidu_search</span><span class="params">(self, x)</span>:</span></div><div class="line">        self.tag= <span class="string">'tt'</span></div><div class="line">        <span class="string">"""Test search"""</span></div><div class="line">        self.baidu.search(x)</div><div class="line">        <span class="keyword">assert</span> <span class="number">1</span>== <span class="number">1</span></div><div class="line"><span class="meta">    @Test()</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_baidu_set</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""Test set preference"""</span></div><div class="line">        print(<span class="string">'NONONO'</span>)</div><div class="line">        self.baidu.preferences()</div><div class="line">        <span class="keyword">assert</span> <span class="number">1</span>==<span class="number">0</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser.delete_all_cookies()</div><div class="line">        self.browser.close()</div><div class="line"><span class="meta">    @TearDownClass()</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">after</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span>		</div></pre></td></tr></table></figure></p>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>我来仔细解释下：<br>1.test_case_id： 是测试报告里要显示的test_case_id, 一般跟你testcenter里的test_id相同，如果你一个测试类共用一个id， 你定义为类属性就可以。 如果你每个测试用例不同id，你在每个测试函数里，重写它就可以。 框架会为你替换。<br>2.tags: 是每个用例的tag，定义在类属性里，test_finder查找时会解析这个tags，可以是str或者list或者tuple，或者是3者的嵌套。 框架最终会解析成一个list。<br>比如你定义 tags=[‘smoke’,’bvt’] 和你定义 ‘smoke, bvt’是一样的效果。 当用户指定了要跑的tag属性时候，test_finder会根据它的值来做filter。<br>3.@SetUpClass()， @TearDownClass() 测试类装饰器，无输入参数。 每个测试类，不管它有多少个测试用例，这两个装饰器装饰的函数只会被执行一次。 一般用作测试类公用的数据的初始化，比如说，连接db查找某些值。 请注意， 并发运行，不要在这个函数里初始化你的browser，会有共享问题。<br>4.@TestClass（）， 测试类的装饰类， 函数接受两个个参数一个是group，就是测试类所属的group，一个是enabled，默认值True。 值为False时， test_finder会把这个测试类略过。<br>5.@Test（）， 测试装饰类， 函数接受一个参数enabled，默认值True。 值为False时， test_finder会把这个测试函数略过。<br>6.@data_provider（）， 数据驱动装饰器。 接受一个参数，且此参数必须要iterable. 因为是数据驱动，不太可能只有一个数据，所以这个iterable，我通常我会定义成一个tuple，如果 有多个就是多个tuple， 例如[(1,2,3),(4,5,6)]这种，（1，2，3）会被解析成一条测试数据， （4，5，6）会被解析成另外一条。 这个概念来自ddt，我之前也介绍过相关框架。<br>7.@setUP（）， @tearDown().两个函数，每个测试类必须定义，否则运行时框架会报错。 用作每个测试类的测试函数即每一条测试用例的运行前初始化和运行后的清理。<br>定义一次， 由它装饰的函数会在每个测试用例运行前后调用。 一般在里面初始化web browser和 API的 session。</p>
<p>测试函数，就是以@Test（）装饰的函数，一般是你的业务代码，你需要自己实现业务流程的操作和断言。如果用到setUpClass或者setUp里的方法属性，你只需要在这些属性前加self.<br>它不像pytest或者unittest，此函数名不必以test开头或结尾。</p>
<p>以上基本参照了pytest和unittest的用法，主要初衷也是为了减少迁移成本。</p>
<p>好，我测试类，测试函数都写好了，如何跑呢？</p>
<h4 id="可用参数"><a href="#可用参数" class="headerlink" title="可用参数"></a>可用参数</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#最简单在命令行里输入ktest 即可， 框架会自动查询所有你项目文件下tests文件夹的测试用例。</div><div class="line">#ktest还支持如下参数：</div><div class="line">usage: ktest [-h]</div><div class="line">             [-t test     targets, should be either folder or .py file, this should be the root folder of your test cases or .py file of your test classes.]</div><div class="line">             [-i user provided tags,     string only, separate by comma without an spacing among all tags. if any user provided     tags are defined in test class, the test class will be considered to run. | -ai user provided tags,    string only, separate by comma without an spacing among all tags.    only all of user provided tags are defined in test class, the test class will be considered to run.]</div><div class="line">             [-e user provided tags,     string only, separate by comma without an spacing among all tags,if any user provided     tags are defined in test class, the test class will be Excluded. | -ae user provided tags,    string only, separate by comma without an spacing among all tags.    all the provided tags must defined in test class as well.]</div><div class="line">             [-I include groups,     string only, separated by comma for each tag.    if any user provided groups are defined in decorator on top of test class, the test class will be considered to run. | -AI exclude groups,     string only, separated by comma for each tag.    all user provided groups are defined in decorator on top of test class, the test class which match will be excluded to run.]</div><div class="line">             [-E exclude groups,    defined in decorator on top of test class, string only, separated by comma for each tag.     If any user provided groups are defined in decorator on top of test class, the test class will be Excluded to run | -AE exclude groups,    defined in decorator on top of test class, string only, separated by comma for each tag.     All user provided groups must defined in decorator on top of test class. the test class which matched will be Excluded to run]</div><div class="line">             [-n int number] [-r dir]</div></pre></td></tr></table></figure>
<p>其中：<br>-t 是你要运行的测试目标的根目录，默认是项目下的tests文件夹。<br>-i 是测试类里定义的tags。 tags会被解析成list，用户指定的任何tag只要包含在这个lists里，并且这个测试函数所属的TestClass（）是enabled和这个测试函数的enabled是True，就表示这个测试类的这个测试函数会被test_filder找到。<br>-I 是装饰测试类的@TestClass（）定义的group，包含两个参数， 符合用户指定的group并enabled， 那么它装饰的类会被当作一个测试类被test_finder找到。<br>-e 是测试类里定义的tags。 tags会被解析成list。 用户指定的任何tags包含在list里，这个测试函数就会被test_finder忽略。<br>-E 是测试类里定义的tags。 tags会被解析成list。 用户指定的任何tags包含在list里，这个测试函数就会被test_finder忽略。<br>-n 并发执行的个数，默认是cpu_count。<br>-r 错误重跑， 默认是True。重跑再错误，所有跟case相关的log和screenshot会被记录。</p>
<p>Note：<br>1.这种默认下，测试用例（测试类）的tags解析出来的的任意子集，如果用户指定的group或者tag是包含它，那么他会被test_finder找到。 比如-test就跑包括了test这个tag的用例。 比如你有两个测试类，一个测试类的tag是test，另外一个测试类的tags是regression，  用户给了-i test,regression. 那么这两个测试类所属的测试用例都会被扫描到并且添加进待测list里。<br>2.所有的用户输入只支持str。 tag本身不必要加引号，除非它在测试类里也加了引号。 且多个tag直接用逗号隔开即可，不必加空格。<br>有的同学会问了，我希望跑同时包括test和regression在内这两个tags的用例呢？ 谁提出的这个需求？我真想指着你的鼻子说：<br>没有问题，统统实现！<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"># 定义了tag和group的更加严格版。只有用户输入的参数全部包含在测试用例定义的tags里，这个测试用例才会被test_finder扫描到。</div><div class="line">  -ai user provided tags,    string only, separate by comma without an spacing among all tags.    only all of user provided tags are defined in test class, the test class will be considered to run.</div><div class="line">                        Select test cases to run by tags, separated by comma,</div><div class="line">                        no blank space among tag values. all user provided</div><div class="line">                        tags must defined in test class as well. tags are</div><div class="line">                        defined in test class with name &lt;tags&gt;. eg: tags =</div><div class="line">                        ['smoke', 'regression']. tags value in test class can</div><div class="line">                        be string, tuple or list.</div><div class="line"> </div><div class="line">  -ae user provided tags,    string only, separate by comma without an spacing among all tags.    all the provided tags must defined in test class as well.</div><div class="line">                        Exclude test cases by tags, separated by comma, no</div><div class="line">                        blank space among tag values. all of the tags user</div><div class="line">                        provided must in test class as well. tags are defined</div><div class="line">                        in test class with name &lt;tags&gt;. eg: tags = ['smoke',</div><div class="line">                        'regression']. tags value in test class can be string,</div><div class="line">                        tuple or list.</div><div class="line">						</div><div class="line">  -AI exclude groups,     string only, separated by comma for each tag.    all user provided groups are defined in decorator on top of test class, the test class which match will be excluded to run.</div><div class="line">                        Select test cases belong to groups, separated by</div><div class="line">                        comma, no blank space among group values. All user</div><div class="line">                        provided group must defined in decorator on top of</div><div class="line">                        test class, the test class which match will be</div><div class="line">                        collected. groups are defined in decorator on top of</div><div class="line">                        test class. eg: group= 'UI'.</div><div class="line"> </div><div class="line">  -AE exclude groups,    defined in decorator on top of test class, string only, separated by comma for each tag.     All user provided groups must defined in decorator on top of test class. the test class which matched will be Excluded to run</div><div class="line">                        Exclude test cases belong to groups, separated by</div><div class="line">                        comma, no blank space among group values. All of</div><div class="line">                        groups user provided must defined in decorator on top</div><div class="line">                        of test class as well. groups are defined in decorator</div><div class="line">                        on top of test class. eg: group= 'UI'.</div><div class="line">#事实上， 为避免用法繁琐及方便用户， -i 和-ai， -e和-ae, -I和-AI, -E和-AE 是两两互斥的， 你只能指定其中的一个。</div></pre></td></tr></table></figure></p>
<h4 id="测试报告"><a href="#测试报告" class="headerlink" title="测试报告"></a>测试报告</h4><p>下面我们看下一个运行实例<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ktest -I group -n <span class="number">10</span> -r <span class="keyword">True</span></div></pre></td></tr></table></figure><br>执行中console的输出：<br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/run_console.JPG" alt=""></p>
<h4 id="执行成功后报告的展示："><a href="#执行成功后报告的展示：" class="headerlink" title="执行成功后报告的展示："></a>执行成功后报告的展示：</h4><p>report会自动生成在你项目根目录下，以运行时时间戳为文件夹，每个测试用例一个子文件夹<br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/html_report_folder.JPG" alt=""></p>
<p>测试报告加入了run pass， run fail， run error的图表。 run fail代表真正的fail， run error代表代码有问题或者环境问题导致的错误。<br>同样报告直接按照测试类filter。<br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/html_report.JPG" alt=""></p>
<h4 id="后记："><a href="#后记：" class="headerlink" title="后记："></a>后记：</h4><p>到此为止，ktest基本成型，也能根据需求完成web UI自动化和API自动化的工作了，不同无非是你在setUP初始化你的driver时候初始化的是你的browser还是request.session. 如果你想实现分布式并发，也可以在setUP initial selenium Grid， 前提是配置好selenium-server。</p>
<h4 id="还是有一些感悟："><a href="#还是有一些感悟：" class="headerlink" title="还是有一些感悟："></a>还是有一些感悟：</h4><p>1.框架真不是一蹴而就的，是逐渐演化的。 最后成型的这一版跟我初始的规划还是有很大差距，有些代码甚至是不得已的妥协，比如我要出html报告，就要很多测试函数无关的数据收集，那么这些数据势必会侵入我的代码，结果就是我返回的测试函数数据结构很不简洁。<br>2.我最得意的是没有用大家都推崇的多线程threading.Thread，整个框架没有一行threading.Threadd 代码而实现了多线程并发，可阅读性增加了，而且我的代码量也因此少了三分之一， 虽然踩了不少坑，但也证明条条大路通罗马，只要理论通了，怎么实现，完全看个人喜欢。实际上threading.Thread实现太过繁琐，我几乎是一开始就否定了它。<br>3.你完全不需要搭积木， 一砖一瓦也能创建出漂亮的房子。</p>
<h4 id="彩蛋："><a href="#彩蛋：" class="headerlink" title="彩蛋："></a>彩蛋：</h4><p>放部分代码段：<br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/set_up_class_decorator.JPG" alt=""><br><img src="/2018/12/29/测试框架/自研测试框架Ktest介绍/test_finder.JPG" alt=""><br>关于更多技术实现细节，我会重新写一篇文章介绍。</p>

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>🐶 您的支持将鼓励我继续创作 🐶</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赞赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat-reward-img.jpg" alt="请关注微信公众号 iTesting WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay-reward-img.jpg" alt="请关注微信公众号 iTesting Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>
	<div>
	  
		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------评论, 吐槽, 学习交流，请关注微信公众号 iTesting-------------</i></div>
    
</div>
	  
	</div>
    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.jpg" alt="请关注微信公众号 iTesting wechat" style="width: 200px; max-width: 100%;"/>
    <div>扫码关注，跟作者互动</div>
</div>


      
    </div>
  
        <div class="post-tags">
          
            <a href="/tags/测试框架/" rel="tag"># 测试框架</a>
          
            <a href="/tags/automation/" rel="tag"># automation</a>
          
        </div>
      
	<div>
		  
			
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  <!-- JS库 sweetalert 可修改路径 -->
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2018/12/29/测试框架/自研测试框架Ktest介绍/">自研测试框架Ktest介绍</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 请关注微信公众号 iTesting 的个人博客">请关注微信公众号 iTesting</a></p>
  <p><span>发布时间:</span>2018年12月29日 - 22:12</p>
  <p><span>最后更新:</span>2019年01月24日 - 23:01</p>
  <p><span>原始链接:</span><a href="/2018/12/29/测试框架/自研测试框架Ktest介绍/" title="自研测试框架Ktest介绍">http://www.helloqa.com/2018/12/29/测试框架/自研测试框架Ktest介绍/</a>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    clipboard.on('success', $(function(){
      $(".fa-clipboard").click(function(){
        swal({   
          title: "",   
          text: '复制成功',   
          html: false,
          timer: 500,   
          showConfirmButton: false
        });
      });
    }));  
</script>

		  
	</div>

    <footer class="post-footer">

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/11/24/测试框架/测试框架实践--实现TestFixture/" rel="next" title="测试框架实践--实现TestFixture">
                <i class="fa fa-chevron-left"></i> 测试框架实践--实现TestFixture
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/30/接口测试/一小时学会接口测试/" rel="prev" title="一小时学会接口测试">
                一小时学会接口测试 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="请关注微信公众号 iTesting" />
		  
          <p class="site-author-name" itemprop="name"><a href= "/about">请关注微信公众号 iTesting</a></p>
		  
          <p class="site-description motion-element" itemprop="description">测试专家。图书<前端自动化测试框架--Cypress从入门到精通>、<从0到1搭建自动化测试框架：原理、实现与工程实践>作者。拉勾教育<测试开发入门与实践>专栏作者。 精通Cypress，熟练掌握Python，测试框架开发，测试平台开发，自动化测试，接口测试，长期致力于软件测试的技术传播工作。 联系微信：BetterThinkBig 。</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/">
                <span class="site-state-item-count">118</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/thinkbig" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="/uploads/wechat-qcode.jpg" target="_blank" title="微信公众号">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微信公众号
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="/uploads/thinkbig.jpg" target="_blank" title="我的微信">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  我的微信
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              关于我
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://item.jd.com/12647091.html" title="Cypress新书" target="_blank">Cypress新书</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://item.jd.com/13534616.html" title="自动化测试框架新书" target="_blank">自动化测试框架新书</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://t10.lagounews.com/3RFFRvRFcJD02" title="拉勾专栏" target="_blank">拉勾专栏</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#痛点："><span class="nav-number">1.</span> <span class="nav-text">痛点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#解决方案："><span class="nav-number">2.</span> <span class="nav-text">解决方案：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#框架是什么？我是怎么考虑框架的？"><span class="nav-number">3.</span> <span class="nav-text">框架是什么？我是怎么考虑框架的？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#什么是ktest？"><span class="nav-number">4.</span> <span class="nav-text">什么是ktest？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参考了谁？"><span class="nav-number">5.</span> <span class="nav-text">参考了谁？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实现的功能："><span class="nav-number">6.</span> <span class="nav-text">实现的功能：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#详细介绍"><span class="nav-number">7.</span> <span class="nav-text">详细介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#安装："><span class="nav-number">8.</span> <span class="nav-text">安装：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#你的项目应该包括哪些："><span class="nav-number">9.</span> <span class="nav-text">你的项目应该包括哪些：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ktest框架组成"><span class="nav-number">10.</span> <span class="nav-text">ktest框架组成</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#功能列表"><span class="nav-number">11.</span> <span class="nav-text">功能列表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集成你的项目"><span class="nav-number">12.</span> <span class="nav-text">集成你的项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注意事项"><span class="nav-number">13.</span> <span class="nav-text">注意事项</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#可用参数"><span class="nav-number">14.</span> <span class="nav-text">可用参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#测试报告"><span class="nav-number">15.</span> <span class="nav-text">测试报告</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#执行成功后报告的展示："><span class="nav-number">16.</span> <span class="nav-text">执行成功后报告的展示：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#后记："><span class="nav-number">17.</span> <span class="nav-text">后记：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#还是有一些感悟："><span class="nav-number">18.</span> <span class="nav-text">还是有一些感悟：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#彩蛋："><span class="nav-number">19.</span> <span class="nav-text">彩蛋：</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  Copyright &nbsp 
  &copy; 2017 - 
  <span itemprop="copyrightYear">2021 &nbsp&nbsp Designed by helloqa</span>
  
  <span class="with-love">
    <i class="fa fa-wechat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">请关注微信公众号 iTesting</span>
</div>


<!--

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>

-->  


        <!-- 

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>


 -->
        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


</body>
</html>
