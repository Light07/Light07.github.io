<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误，请关注公众号iTesting获取密码');
                history.back();
            }
        }
    })();
</script>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  






  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Mobile-Test," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="如何在Windows上搭建Appium测试框架？">
<meta property="og:type" content="article">
<meta property="og:title" content="Appium自动化框架入门实践">
<meta property="og:url" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/index.html">
<meta property="og:site_name" content="iTesting软件测试知识分享">
<meta property="og:description" content="如何在Windows上搭建Appium测试框架？">
<meta property="og:image" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/1.png">
<meta property="og:image" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/2.png">
<meta property="og:image" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/3.png">
<meta property="og:image" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/4.png">
<meta property="og:image" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/5.png">
<meta property="og:updated_time" content="2017-06-19T09:49:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Appium自动化框架入门实践">
<meta name="twitter:description" content="如何在Windows上搭建Appium测试框架？">
<meta name="twitter:image" content="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/"/>





  <title> Appium自动化框架入门实践 | iTesting软件测试知识分享 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>
	<a href="https://github.com/Light07/flask_blog" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

<!--
  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">iTesting软件测试知识分享</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">iTesting</h1>
    
</div>
-->

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
		
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-basic-knowledge">
          <a href="/categories/basic-knowledge" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            测试理论
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-dev-in-test">
          <a href="/categories/dev-in-test" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flask"></i> <br />
            
            测试开发
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-automation">
          <a href="/categories/automation" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-desktop"></i> <br />
            
            自动化测试
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-api-test">
          <a href="/categories/api-test" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-paper-plane-o"></i> <br />
            
            接口测试
          </a>
        </li>
		
      
        
		
        <li class="menu-item menu-item-mobile-test">
          <a href="/categories/mobile-test" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-mobile"></i> <br />
            
            移动端测试
          </a>
        </li>
		
      
        
		
      
        
		
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.helloqa.com/2017/06/14/移动测试系列/Appium自动化框架入门实践/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="请关注微信公众号 iTesting">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="iTesting软件测试知识分享">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="iTesting软件测试知识分享" src="/images/avatar.jpg">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                Appium自动化框架入门实践
              
            
          </h2>
        

        <div class="post-meta">
        
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-14T14:28:58+08:00">
                2017-06-14
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2017-06-19T17:49:25+08:00">
                2017-06-19
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mobile-test/" itemprop="url" rel="index">
                    <span itemprop="name">mobile-test</span>
                  </a>
                </span>

                
                
              
            </span>
          
			  <span class="post-meta-divider">|</span>
			  <span class="post-meta-item-icon">
               <i class="fa fa-folder-o"></i>
              </span>
			  <span class="post-count">全文共计1.8k字</span>
			  <span class="post-meta-divider">|</span>
			  <span class="post-meta-item-icon">
               <i class="fa fa-folder-o"></i>
              </span>
			  <span class="post-count">预计阅读时间9分钟</span>

          
            
          

          

          
          

          

          




        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>如何在Windows上搭建Appium测试框架？<br><a id="more"></a></p>
<h5 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h5><ol>
<li>Download latest <a href="https://nodejs.org/dist/v6.10.0/" target="_blank" rel="external">node and npm</a> tools MSI (version &gt;= 6.0). The npm and nodejs paths should be in your PATH environment variable.</li>
<li>Open admin cmd prompt,  Run the command <strong> npm install -g appium </strong> which will install Appium from NPM</li>
<li>To start Appium, you can now simply run appium from the prompt.<br> 3.1 On Windows run Appium.exe as an administrator, or when running from source you need to run cmd as an administrator.<br> 3.2 You must supply the <strong> –no-reset </strong> or <strong> –full-reset </strong> flags for Android to work on Windows, all other flags are <a href="http://appium.io/slate/en/master/?python#server-flags" target="_blank" rel="external">here</a></li>
<li>Follow the directions below for setup for either Android or Windows app testing.<br> 4.1 Download the latest <a href="http://developer.android.com/sdk/index.html" target="_blank" rel="external">Java JDK</a>. Set <strong> ‘JAVA_HOME’ </strong> to be your JDK path. The bin in that directory should be added to your <strong> PATH </strong> variable.<br> 4.2 Install the <a href="http://developer.android.com/sdk/index.html" target="_blank" rel="external">Android SDK</a>. Set the <strong> ANDROID_HOME  </strong> environment variable to be your Android SDK path and add the tools and platform-tools folders to your PATH variable.<br> 4.3 To run tests on Windows, you will need to have the Android Emulator booted or an Android Device connected that is running an AVD with API Level 17 or greater. Then run Appium on the command line (via the appium command)<br> 4.4 Your test script should ensure that the <strong> platformVersion </strong> capability corresponds to the emulator or device version you are testing, and that the app capability is an absolute path to the .apk file of the Android app.</li>
<li>Install the Python client library <strong> pip install Appium-Python-Client </strong></li>
<li>Run a test from any Appium client.<br> 6.1 real device<br> 6.2 simulator–Genymotion</li>
</ol>
<h5 id="元素识别"><a href="#元素识别" class="headerlink" title="元素识别"></a>元素识别</h5><p>我们用真机来测试，windows平台上appium只有android配置项，首先打开appium， 配置如下：<br><img src="/2017/06/14/移动测试系列/Appium自动化框架入门实践/1.png" alt="Appium配置"></p>
<p>解释如下：<br>Application path: apk路径<br>Capabilities:<br>    automationName    Which automation engine to use    Appium (default) or Selendroid<br>    platformName    Which mobile OS platform to use    iOS, Android, or FirefoxOS<br>    platformVersion    Mobile OS version    e.g., 7.1, 4.4<br>    deviceName:   command line 运行 <strong> adb devices  </strong> 得到的结果。<br>    noReset    Don’t reset app state before this session. See here for more details    true, false<br>    fullReset    Perform a complete reset. See here for more details    true, false<br>注意，在windows平台上， fullreset 和noreset一定要选一个。</p>
<p>点击右上角的launch the appium node启动appium，点击inpect图标，等server起来后，在device上打开要测试的app。<br><img src="/2017/06/14/移动测试系列/Appium自动化框架入门实践/2.png" alt="Appium配置"></p>
<p>这个就列出来当前页面的各个元素，方便我们识别元素。 对于Android来说，android SDK 有个自带的ui automation viewer也同样可以用，打开来如下（同样要求连接设备）<br><img src="/2017/06/14/移动测试系列/Appium自动化框架入门实践/3.png" alt="Appium配置"></p>
<h5 id="元素识别-1"><a href="#元素识别-1" class="headerlink" title="元素识别"></a>元素识别</h5><p>对于mobile的元素识别，参看我之前文章：<br><a href="http://helloqa.com/2017/04/02/%E7%A7%BB%E5%8A%A8%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97/UIAutomation%20Viewer%E5%AE%9A%E4%BD%8DAndroid%20APP%E5%85%83%E7%B4%A0/" target="_blank" rel="external">UIAutomation Viewer定位Android APP元素</a><br><a href="http://helloqa.com/2017/04/02/%E7%A7%BB%E5%8A%A8%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97/%E5%88%A9%E7%94%A8Android%20UiSelector%EF%BC%88%EF%BC%89%E7%B1%BB%E6%9D%A5%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0/" target="_blank" rel="external">利用Android UiSelector（）类来定位元素</a><br><a href="http://helloqa.com/2017/04/02/%E7%A7%BB%E5%8A%A8%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97/iOS%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%85%83%E7%B4%A0%E5%AE%9A%E4%BD%8D/" target="_blank" rel="external">iOS自动化测试之元素定位</a></p>
<h5 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h5><p>我们以我司的一个app为例，测试下内容：<br>1.Launch app，输入错误的用户名和密码<br>2.点击登录<br>3.验证弹出错误对话框中的text为Username or password incorrect。示例如下：<br><img src="/2017/06/14/移动测试系列/Appium自动化框架入门实践/4.png" alt="app截屏"></p>
<p>保持上一步appium的配置，启动launch the appium node后， 代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">from</span> appium <span class="keyword">import</span> webdriver</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestAPP</span><span class="params">()</span>:</span></div><div class="line">    desired_caps = &#123;&#125;</div><div class="line">    desired_caps[<span class="string">'platformName'</span>] = <span class="string">'Android'</span></div><div class="line">    desired_caps[<span class="string">'platformVersion'</span>] = <span class="string">'5.0'</span></div><div class="line">    desired_caps[<span class="string">'deviceName'</span>] = <span class="string">'a92e11aa'</span></div><div class="line">    desired_caps[<span class="string">'app'</span>] = <span class="string">r"D:/_Automation/Mobile_FrameWork/EvcMobile/apps/evc.apk"</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser = webdriver.Remote(<span class="string">'http://localhost:4723/wd/hub'</span>, self.desired_caps)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_username_or_email</span><span class="params">(self, username)</span>:</span></div><div class="line">        time.sleep(<span class="number">10</span>)</div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/username']"</span>).click()</div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/username']"</span>).send_keys(username)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_password</span><span class="params">(self, password)</span>:</span></div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/password']"</span>).click()</div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/password']"</span>).send_keys(password)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">click_login_button</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/login']"</span>).click()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    test = TestAPP()</div><div class="line">    test.set_username_or_email(<span class="string">"iTesting"</span>)</div><div class="line">    test.set_password(<span class="number">1</span>)</div><div class="line">    test.click_login_button()</div><div class="line">    time.sleep(<span class="number">1</span>)</div><div class="line">    <span class="keyword">print</span> (test.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/notificationText']"</span>).get_attribute(<span class="string">'text'</span>))</div><div class="line">    <span class="keyword">assert</span> test.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/notificationText']"</span>).get_attribute(<span class="string">'text'</span>) == <span class="string">"Username or password incorrect"</span></div></pre></td></tr></table></figure></p>
<p>正常运行，代码没有问题，appium自动化的第一步就算完成了。</p>
<h5 id="框架优化step-1-，分离测试代码和被测试app，-并添加测试框架unittest，："><a href="#框架优化step-1-，分离测试代码和被测试app，-并添加测试框架unittest，：" class="headerlink" title="框架优化step 1 ，分离测试代码和被测试app， 并添加测试框架unittest，："></a>框架优化step 1 ，分离测试代码和被测试app， 并添加测试框架unittest，：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> unittest</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">from</span> appium <span class="keyword">import</span> webdriver</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EFAPP</span><span class="params">()</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, driver)</span>:</span></div><div class="line">        self.browser = driver</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_username_or_email</span><span class="params">(self, username)</span>:</span></div><div class="line">        time.sleep(<span class="number">10</span>)</div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/username']"</span>).click()</div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/username']"</span>).send_keys(username)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_password</span><span class="params">(self, password)</span>:</span></div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/password']"</span>).click()</div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/password']"</span>).send_keys(password)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">click_login_button</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/login']"</span>).click()</div><div class="line">        time.sleep(<span class="number">2</span>)</div><div class="line">        <span class="keyword">assert</span> self.browser.find_element_by_xpath(<span class="string">"//*[@resource-id='com.ef.evc2015:id/notificationText']"</span>).get_attribute(<span class="string">'text'</span>) == <span class="string">"Username or password incorrect"</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EFAPPTests</span><span class="params">(unittest.TestCase)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        desired_caps = &#123;&#125;</div><div class="line">        desired_caps[<span class="string">'platformName'</span>] = <span class="string">'Android'</span></div><div class="line">        desired_caps[<span class="string">'platformVersion'</span>] = <span class="string">'5.0'</span></div><div class="line">        desired_caps[<span class="string">'deviceName'</span>] = <span class="string">'a92e11aa'</span></div><div class="line">        desired_caps[<span class="string">'app'</span>] = <span class="string">r"D:/_Automation/Mobile_FrameWork/EvcMobile/apps/evc.apk"</span></div><div class="line"></div><div class="line">        self.browser = webdriver.Remote(<span class="string">'http://localhost:4723/wd/hub'</span>, desired_caps)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_login_failure</span><span class="params">(self)</span>:</span></div><div class="line">        ef_app = EFAPP(self.browser)</div><div class="line">        ef_app.set_username_or_email(<span class="string">"iTesting"</span>)</div><div class="line">        ef_app.set_password(<span class="number">1</span>)</div><div class="line">        ef_app.click_login_button()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser.quit()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    suite = unittest.TestLoader().loadTestsFromTestCase(EFAPPTests)</div><div class="line">    unittest.TextTestRunner(verbosity=<span class="number">2</span>).run(suite)</div></pre></td></tr></table></figure>
<p>运行结果如下：<br><img src="/2017/06/14/移动测试系列/Appium自动化框架入门实践/5.png" alt="运行结果"></p>
<p>看起来像大功告成了，不过还有一个问题，所有的待测元素全都写在方法内部，不利于管理和重用，每次xpath改动，都需要改动每个方法。</p>
<h5 id="框架优化step-2，-加入page-object模式。"><a href="#框架优化step-2，-加入page-object模式。" class="headerlink" title="框架优化step 2， 加入page_object模式。"></a>框架优化step 2， 加入page_object模式。</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> unittest</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</div><div class="line"><span class="keyword">from</span> DateTime <span class="keyword">import</span> DateTime</div><div class="line"><span class="keyword">from</span> assertpy <span class="keyword">import</span> assert_that</div><div class="line"><span class="keyword">from</span> page_objects <span class="keyword">import</span> PageObject, PageElement</div><div class="line"><span class="keyword">from</span> appium <span class="keyword">import</span> webdriver</div><div class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support.wait <span class="keyword">import</span> WebDriverWait</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasePage</span><span class="params">(PageObject)</span>:</span></div><div class="line">    __metaclass__ = ABCMeta</div><div class="line"></div><div class="line">    WAIT_FOR_SCROLL_TIME = <span class="number">2</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, driver)</span>:</span></div><div class="line">        <span class="comment"># Don't change the variable name w. it's used by PageObject</span></div><div class="line">        self.w = driver</div><div class="line">        self.driver = driver</div><div class="line">        assert_that(self.has_loaded()).is_true()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">has_loaded</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="keyword">return</span> self.is_target_page()</div><div class="line">        <span class="keyword">except</span> NoSuchElementException:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line">    <span class="comment"># This function will be implement by sub class</span></div><div class="line"><span class="meta">    @abstractmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_target_page</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_element_displayed</span><span class="params">(self, by, value, timeout=<span class="number">60</span>)</span>:</span></div><div class="line">        <span class="keyword">return</span> WebDriverWait(self.driver, timeout).until(</div><div class="line">            <span class="keyword">lambda</span> driver: driver.find_element(by, value).is_displayed())</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EFAPP</span><span class="params">(BasePage)</span>:</span></div><div class="line"></div><div class="line">    EMAIL_OR_USERNAME_TEXT_FIELD_XPATH =<span class="string">"//*[@resource-id='com.ef.evc2015:id/username']"</span></div><div class="line">    PASSWORD_TEXT_FIELD_XPATH = <span class="string">"//*[@resource-id='com.ef.evc2015:id/password']"</span></div><div class="line">    LOGIN_BUTTON_XPATH = <span class="string">"//*[@resource-id='com.ef.evc2015:id/login']"</span></div><div class="line">    LOGIN_ERROR_XPATH = <span class="string">"//*[@resource-id='com.ef.evc2015:id/notificationText']"</span></div><div class="line"></div><div class="line">    email_or_username_text_field = PageElement(xpath=EMAIL_OR_USERNAME_TEXT_FIELD_XPATH)</div><div class="line">    password_text_field = PageElement(xpath=PASSWORD_TEXT_FIELD_XPATH)</div><div class="line">    login_button = PageElement(xpath=LOGIN_BUTTON_XPATH)</div><div class="line">    error_message = PageElement(xpath=LOGIN_ERROR_XPATH)</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, driver)</span>:</span></div><div class="line">        BasePage.__init__(self, driver)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_target_page</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.is_element_displayed(By.XPATH, self.EMAIL_OR_USERNAME_TEXT_FIELD_XPATH)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_username_or_email</span><span class="params">(self, username)</span>:</span></div><div class="line">        self.email_or_username_text_field.click()</div><div class="line">        self.email_or_username_text_field.send_keys(username)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_password</span><span class="params">(self, password)</span>:</span></div><div class="line">        self.password_text_field.click()</div><div class="line">        self.password_text_field.send_keys(password)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">click_login_button</span><span class="params">(self)</span>:</span></div><div class="line">        self.login_button.click()</div><div class="line">        time.sleep(<span class="number">2</span>)</div><div class="line">        <span class="keyword">assert</span> self.error_message.get_attribute(<span class="string">'text'</span>) == <span class="string">"Username or password incorrect"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EFAPPTests</span><span class="params">(unittest.TestCase)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        desired_caps = &#123;&#125;</div><div class="line">        desired_caps[<span class="string">'platformName'</span>] = <span class="string">'Android'</span></div><div class="line">        desired_caps[<span class="string">'platformVersion'</span>] = <span class="string">'5.0'</span></div><div class="line">        desired_caps[<span class="string">'deviceName'</span>] = <span class="string">'a92e11aa'</span></div><div class="line">        desired_caps[<span class="string">'app'</span>] = <span class="string">r"D:/_Automation/Mobile_FrameWork/EvcMobile/apps/evc.apk"</span></div><div class="line"></div><div class="line">        self.browser = webdriver.Remote(<span class="string">'http://localhost:4723/wd/hub'</span>, desired_caps)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_login_failure</span><span class="params">(self)</span>:</span></div><div class="line">        ef_app = EFAPP(self.browser)</div><div class="line">        ef_app.set_username_or_email(<span class="string">"iTesting"</span>)</div><div class="line">        ef_app.set_password(<span class="number">1</span>)</div><div class="line">        ef_app.click_login_button()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></div><div class="line">        self.browser.quit()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    suite = unittest.TestLoader().loadTestsFromTestCase(EFAPPTests)</div><div class="line">    unittest.TextTestRunner(verbosity=<span class="number">2</span>).run(suite)</div><div class="line"></div></pre></td></tr></table></figure>
<p>等等，是不是少了点什么？ 一旦你关闭了appium，所有的测试都会失败，</p>
<h5 id="框架优化step-3，-监测，启动，关闭appium。"><a href="#框架优化step-3，-监测，启动，关闭appium。" class="headerlink" title="框架优化step 3， 监测，启动，关闭appium。"></a>框架优化step 3， 监测，启动，关闭appium。</h5><p>在代码里添加如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppiumUtils</span><span class="params">()</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment">#start adb</span></div><div class="line">        os.system(<span class="string">'taskkill /F /IM adb.exe'</span>)</div><div class="line">        os.system(<span class="string">'adb devices'</span>)</div><div class="line">        <span class="comment">#launch appium</span></div><div class="line">        os.system(<span class="string">'taskkill /F /IM node.exe'</span>)</div><div class="line">        command = <span class="string">''' start /b "" "&#123;node_exe_path&#125;" "&#123;appium_js_path&#125;" --address "&#123;server_ip&#125;" --port "&#123;port&#125;" --command-timeout "&#123;command_timeout&#125;" --platform-name "&#123;platform_name&#125;" --platform-version "&#123;platform_version&#125;" --device-name "&#123;device_name&#125;" --app "&#123;app&#125;" --no-reset --log-no-color &gt; "&#123;log_path&#125;" '''</span></div><div class="line">        os.system(<span class="string">"%s"</span> % command)</div><div class="line">        time.sleep(<span class="number">60</span>) <span class="comment"># wait appium start completely.</span></div></pre></td></tr></table></figure><br>这段代码目的是为了每次自动化开始时候，杀掉所有影响启动的appium服务，以确保每次appium都能正确启动，其中，大括号包起来的是你自己需要配置的各个配置项，最后一个sleep语句我简化了，其实可以动态判断appium有没有启动，这个不深入了。</p>
<p>改动EFAPPTests这个类，在setUp里添加如下代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EFAPPTests</span><span class="params">(unittest.TestCase)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        AppiumUtils()</div><div class="line">		。。。</div></pre></td></tr></table></figure></p>
<p>至此， 一个简单的appium测试框架就搭建成功了， 你还可以优化如下：</p>
<ol>
<li>所有配置项单独分开放到config.py 里， 比如device信息， apk信息等。</li>
<li>为每一个待测的case添加一个page，page里为所有这个页面测试需要用到的元素及方法。</li>
<li>利用unittest这个框架，添加新的case，skip掉(@unittest.skip）不需要跑的case。</li>
<li>添加logging模块，记录运行信息。</li>
<li>添加Test Report模块，记录每次运行的结果，划分饼图，等等。</li>
<li>可以利用之前我讲过的ptest自动化框架组织你的用例，这样整个android自动化框架都搭建起来了。</li>
<li>。。。。<br>不断优化，最终会生成最合适的移动端测试框架。</li>
</ol>

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>🐶 您的支持将鼓励我继续创作 🐶</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赞赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat-reward-img.jpg" alt="请关注微信公众号 iTesting WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay-reward-img.jpg" alt="请关注微信公众号 iTesting Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>
	<div>
	  
		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------评论, 吐槽, 学习交流，请关注微信公众号 iTesting-------------</i></div>
    
</div>
	  
	</div>
    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.jpg" alt="请关注微信公众号 iTesting wechat" style="width: 200px; max-width: 100%;"/>
    <div>扫码关注，跟作者互动</div>
</div>


      
    </div>
  
        <div class="post-tags">
          
            <a href="/tags/Mobile-Test/" rel="tag"># Mobile-Test</a>
          
        </div>
      
	<div>
		  
			
		  
	</div>

    <footer class="post-footer">

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/05/18/自动化测试系列/PageObject 模式浅谈/" rel="next" title="PageObject 模式浅谈">
                <i class="fa fa-chevron-left"></i> PageObject 模式浅谈
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/06/测试框架/如何高效组织自动化测试用例/" rel="prev" title="如何高效组织自动化测试用例">
                如何高效组织自动化测试用例 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="请关注微信公众号 iTesting" />
		  
          <p class="site-author-name" itemprop="name"><a href= "/about">请关注微信公众号 iTesting</a></p>
		  
          <p class="site-description motion-element" itemprop="description">测试专家。图书【前端自动化测试框架--Cypress从入门到精通】作者。拉勾教育【测试开发入门与实践】专栏作者，24小时内订阅数超10,000+。 精通Cypress，熟练掌握Python，测试框架开发，测试平台开发，自动化测试，接口测试，长期致力于软件测试的技术传播工作。 联系微信：BetterThinkBig 。</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/">
                <span class="site-state-item-count">112</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/thinkbig" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="/uploads/wechat-qcode.jpg" target="_blank" title="微信公众号">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微信公众号
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="/uploads/thinkbig.jpg" target="_blank" title="我的微信">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  我的微信
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              关于我
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://item.jd.com/12647091.html" title="Cypress新书" target="_blank">Cypress新书</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://t10.lagounews.com/3RFFRvRFcJD02" title="拉勾专栏" target="_blank">拉勾专栏</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#环境安装"><span class="nav-number">1.</span> <span class="nav-text">环境安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#元素识别"><span class="nav-number">2.</span> <span class="nav-text">元素识别</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#元素识别-1"><span class="nav-number">3.</span> <span class="nav-text">元素识别</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#简单示例"><span class="nav-number">4.</span> <span class="nav-text">简单示例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#框架优化step-1-，分离测试代码和被测试app，-并添加测试框架unittest，："><span class="nav-number">5.</span> <span class="nav-text">框架优化step 1 ，分离测试代码和被测试app， 并添加测试框架unittest，：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#框架优化step-2，-加入page-object模式。"><span class="nav-number">6.</span> <span class="nav-text">框架优化step 2， 加入page_object模式。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#框架优化step-3，-监测，启动，关闭appium。"><span class="nav-number">7.</span> <span class="nav-text">框架优化step 3， 监测，启动，关闭appium。</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  Copyright &nbsp 
  &copy; 2017 - 
  <span itemprop="copyrightYear">2021 &nbsp&nbsp Designed by helloqa</span>
  
  <span class="with-love">
    <i class="fa fa-wechat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">请关注微信公众号 iTesting</span>
</div>


<!--

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>

-->  


        <!-- 

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>


 -->
        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


</body>
</html>
